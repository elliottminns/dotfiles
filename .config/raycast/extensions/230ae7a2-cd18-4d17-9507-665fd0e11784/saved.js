"use strict";var v=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var _=Object.getOwnPropertyNames;var B=Object.prototype.hasOwnProperty;var N=(t,e)=>{for(var n in e)v(t,n,{get:e[n],enumerable:!0})},V=(t,e,n,l)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of _(e))!B.call(t,i)&&i!==n&&v(t,i,{get:()=>e[i],enumerable:!(l=E(e,i))||l.enumerable});return t};var H=t=>V(v({},"__esModule",{value:!0}),t);var J={};N(J,{default:()=>q});module.exports=H(J);var S=require("@raycast/api"),P=require("react");var d=require("@raycast/api"),w=require("react/jsx-runtime");var C=t=>(0,w.jsx)(d.Action.CopyToClipboard,{icon:d.Icon.CopyClipboard,...t});var g=({icon:t=d.Icon.Trash,title:e,dialog:n,onAction:l,shortcut:i={modifiers:["cmd"],key:"d"}})=>(0,w.jsx)(d.Action,{style:d.Action.Style.Destructive,icon:t,title:e,onAction:async()=>{await(0,d.confirmAlert)({title:n.title??e,message:n.message??"This action cannot be undone",icon:t,primaryAction:{title:n.primaryButton??e,style:d.Alert.ActionStyle.Destructive,onAction:l}})},shortcut:i});var D=require("@raycast/api");var u=require("react/jsx-runtime"),I=({question:t,answer:e})=>(0,u.jsxs)(D.ActionPanel.Section,{title:"Copy",children:[e?(0,u.jsx)(C,{title:"Copy Answer",content:e}):null,t?(0,u.jsx)(C,{title:"Copy Question",content:t}):null]});var m=require("@raycast/api"),h=require("react/jsx-runtime"),L=()=>(0,h.jsx)(m.ActionPanel.Section,{title:"Preferences",children:(0,h.jsx)(m.Action,{icon:m.Icon.Gear,title:"Open Extension Preferences",onAction:m.openExtensionPreferences})});var s=require("@raycast/api"),c=require("react");function x(){let[t,e]=(0,c.useState)([]),[n,l]=(0,c.useState)(!0);(0,c.useEffect)(()=>{(async()=>{let r=await s.LocalStorage.getItem("savedChats");r&&(e(o=>[...o,...JSON.parse(r)]),l(!1))})()},[]),(0,c.useEffect)(()=>{s.LocalStorage.setItem("savedChats",JSON.stringify(t))},[t]);let i=(0,c.useCallback)(async r=>{let o=await(0,s.showToast)({title:"Saving your answer...",style:s.Toast.Style.Animated}),p={...r,saved_at:new Date().toISOString()};e([...t,p]),o.title="Answer saved!",o.style=s.Toast.Style.Success},[e,t]),A=(0,c.useCallback)(async r=>{let o=await(0,s.showToast)({title:"Unsaving your answer...",style:s.Toast.Style.Animated}),p=t.filter(f=>f.id!==r.id);e(p),o.title="Answer unsaved!",o.style=s.Toast.Style.Success},[e,t]),y=(0,c.useCallback)(async()=>{let r=await(0,s.showToast)({title:"Clearing your saved answers...",style:s.Toast.Style.Animated});e([]),r.title="Saved answers cleared!",r.style=s.Toast.Style.Success},[e]);return(0,c.useMemo)(()=>({data:t,isLoading:n,add:i,remove:A,clear:y}),[t,n,i,A,y])}var T=require("@raycast/api"),k=require("react/jsx-runtime"),b=t=>{let{chat:e,streamData:n}=t,i=`${n&&n.id===e.id?n?.answer:e.answer}`;return(0,k.jsx)(T.List.Item.Detail,{markdown:i})};var a=require("react/jsx-runtime");function q(){let t=x(),[e,n]=(0,P.useState)(""),[l,i]=(0,P.useState)(null),A=o=>(0,a.jsxs)(S.ActionPanel,{children:[(0,a.jsx)(I,{answer:o.answer,question:o.question}),(0,a.jsx)(S.ActionPanel.Section,{title:"Output"}),(0,a.jsxs)(S.ActionPanel.Section,{title:"Delete",children:[(0,a.jsx)(g,{title:"Unsave",dialog:{title:"Are you sure you want to unsave this answer from your collection?"},onAction:()=>t.remove(o)}),(0,a.jsx)(g,{title:"Clear All",dialog:{title:"Are you sure you want to clear all your saved answer from your collection?"},onAction:()=>t.clear(),shortcut:{modifiers:["cmd","shift"],key:"delete"}})]}),(0,a.jsx)(L,{})]}),r=t.data.sort((o,p)=>new Date(p.saved_at??0).getTime()-new Date(o.saved_at??0).getTime()).filter((o,p,f)=>p===f.findIndex(O=>O.id===o.id)).filter(o=>e===""?!0:o.question.toLowerCase().includes(e.toLowerCase())||o.answer.toLowerCase().includes(e.toLowerCase()));return(0,a.jsx)(S.List,{isShowingDetail:r.length!==0,isLoading:t.isLoading,filtering:!1,throttle:!1,navigationTitle:"Saved Answers",selectedItemId:l||void 0,onSelectionChange:o=>{o!==l&&i(o)},searchBarPlaceholder:"Search saved answer/question...",searchText:e,onSearchTextChange:n,children:t.data.length===0?(0,a.jsx)(S.List.EmptyView,{title:"No saved answers",description:"Save generated question with \u2318 + S shortcut",icon:S.Icon.Stars}):(0,a.jsx)(S.List.Section,{title:"Saved",subtitle:r.length.toLocaleString(),children:r.map(o=>(0,a.jsx)(S.List.Item,{id:o.id,title:o.question,accessories:[{text:new Date(o.created_at??0).toLocaleDateString()}],detail:(0,a.jsx)(b,{chat:o}),actions:o&&l===o.id?A(o):void 0},o.id))})})}
